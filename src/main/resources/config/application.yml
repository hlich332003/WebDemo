# ===================================================================
# Spring Boot configuration.
# ===================================================================

spring:
  application:
    name: webDemo
  docker:
    compose:
      enabled: false
  # === OTHER CONFIGURATIONS ===
  messages:
    basename: i18n/messages
  main:
    allow-bean-definition-overriding: true
  security:
    oauth2:
      resourceserver:
        jwt:
          authority-prefix: ''
          authorities-claim-name: auth

  cache: # Thêm cấu hình cache
    type: redis # Bật Redis làm cache chính

# ===================================================================
# JHipster specific properties
# ===================================================================

jhipster:
  clientApp:
    name: 'webDemoApp'
  mail:
    from: webDemo@localhost
  api-docs:
    default-include-pattern: /api/**
    management-include-pattern: /management/**
    title: Web Demo API
    description: Web Demo API documentation
    version: 0.0.1
  security:
    content-security-policy: "default-src 'self'; frame-src 'self' data:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://storage.googleapis.com; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' data:"

---
# ===================================================================
# Profile-specific configuration: dev
# ===================================================================

spring:
  config:
    activate:
      on-profile: dev

  # === DATASOURCE CONFIGURATION (dev) ===
  datasource:
    url: jdbc:sqlserver://localhost:1433;databaseName=jhipster_db;encrypt=true;trustServerCertificate=true
    username: jhipster_user
    password: Jhip@123
    driver-class-name: com.microsoft.sqlserver.jdbc.SQLServerDriver

  # === JPA & HIBERNATE CONFIGURATION (dev) ===
  jpa:
    properties:
      hibernate.dialect: org.hibernate.dialect.SQLServerDialect
      hibernate.jdbc.time_zone: UTC
      hibernate.timezone.default_storage: NORMALIZE
    hibernate:
      ddl-auto: update
      naming:
        physical-strategy: org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
        implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
    show-sql: true

  # === REDIS CONFIGURATION (dev) ===
  redis:
    host: localhost
    port: 6379

  # Mail dev để Spring tạo JavaMailSender
  mail:
    host: localhost
    port: 25
    properties:
      mail.smtp.auth: false
      mail.smtp.starttls.enable: false

management:
  endpoints:
    web:
      exposure:
        include: 'info,health' # Bật endpoint info và health
  health:
    mail:
      enabled: false # Disable mail health check in dev

server:
  port: 8080 # Đã đặt lại cổng về 8080

jhipster:
  security:
    authentication:
      jwt:
        # Dev-only secret. Có thể thay bằng biến môi trường JHIPSTER_SECURITY_AUTHENTICATION_JWT_BASE64_SECRET
        base64-secret: YzBjZjNjN2VjM2IwYzRlYzJhNWI1NTc2ZWFjZTlmMjE0OTNiYjcwZjFlMjZkMWY3ZDI1Nzg1ZWM1MmUyMTU2ZGIzMTNlNDg4MTJmNDg5YWM2MDFlMmVmYTFiYTVmYTFmYjUzNDU4OWRlZjExY2ZlNWM0Njg3NWMzZTNlZGU=
        token-validity-in-seconds: 86400 # 24 hours
        token-validity-in-seconds-for-remember-me: 2592000 # 30 days
