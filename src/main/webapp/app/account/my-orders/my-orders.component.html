<div class="my-orders-container">
  <h2>Đơn hàng của tôi</h2>

  @if (isLoading) {
    <p>Đang tải đơn hàng...</p>
  } @else if (orders.length === 0) {
    <div class="alert alert-warning">Bạn chưa có đơn hàng nào.</div>
  } @else {
    <div class="table-responsive">
      <table class="table table-striped" aria-describedby="my-orders">
        <thead>
          <tr>
            <th scope="col"><span>Mã đơn</span></th>
            <th scope="col"><span>Ngày đặt</span></th>
            <th scope="col"><span>Tổng tiền</span></th>
            <th scope="col"><span>Trạng thái</span></th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          @for (order of orders; track trackId($index, order)) {
            <tr>
              <td>
                <strong>{{ order.orderCode }}</strong>
              </td>
              <td>{{ formatOrderDate(order.orderDate) }}</td>
              <td>
                {{ order.totalAmount | currency: 'VND' : 'symbol' : '1.0-0' }}
              </td>
              <td>
                <span
                  class="badge"
                  [ngClass]="{
                    'bg-warning': order.status === 'PENDING',
                    'bg-info': order.status === 'PROCESSING',
                    'bg-primary': order.status === 'SHIPPED',
                    'bg-success':
                      order.status === 'DELIVERED' ||
                      order.status === 'COMPLETED' ||
                      order.status === 'ĐÃ HOÀN THÀNH',
                    'bg-danger': order.status === 'CANCELLED',
                  }"
                  >{{ getStatusText(order.status) }}</span
                >
              </td>
              <td class="text-end">
                <div class="btn-group">
                  <button
                    type="submit"
                    [routerLink]="['/order', order.id]"
                    class="btn btn-info btn-sm rounded-pill me-1"
                  >
                    <fa-icon icon="eye"></fa-icon>
                    <span class="d-none d-md-inline">Xem chi tiết</span>
                  </button>
                  @if (order.status === 'PENDING') {
                    <button
                      type="button"
                      (click)="cancelOrder(order.id!)"
                      class="btn btn-danger btn-sm rounded-pill"
                    >
                      <fa-icon icon="times"></fa-icon>
                      <span class="d-none d-md-inline">Hủy</span>
                    </button>
                  }
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>
