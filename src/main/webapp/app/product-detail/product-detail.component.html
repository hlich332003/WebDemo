<div class="product-detail-page">
  @if (product) {
    <div class="product-detail-card">
      <div class="product-image-section">
        @if (product.imageUrl) {
          <img
            [src]="product.imageUrl || 'content/images/default-product.svg'"
            [alt]="product.name"
            loading="lazy"
            (error)="onImageError($event)"
          />
        } @else {
          <img src="content/images/default-product.svg" [alt]="product.name" />
        }
      </div>
      <div class="product-info-section">
        <h1 class="product-name">{{ product.name }}</h1>
        <p class="product-description">{{ product.description }}</p>
        <p class="product-price">{{ formatPrice(product.price) }}</p>
        <p class="product-stock">Số lượng tồn kho: {{ product.quantity }}</p>

        <div class="product-actions">
          <button
            type="button"
            (click)="previousState()"
            class="btn btn-outline-info"
          >
            <fa-icon icon="arrow-left"></fa-icon>
            <span>Quay lại</span>
          </button>

          <button
            type="button"
            (click)="toggleWishlist(product)"
            class="btn"
            [class.btn-danger]="isInWishlist(product.id!)"
            [class.btn-outline-danger]="!isInWishlist(product.id!)"
            title="Thêm vào yêu thích"
          >
            <fa-icon icon="heart"></fa-icon>
            <span>Yêu thích</span>
          </button>

          @if (account?.authorities?.includes('ROLE_ADMIN')) {
            <button
              type="button"
              [routerLink]="['/admin/product-management', product.id, 'edit']"
              class="btn btn-primary"
            >
              <fa-icon icon="pencil-alt"></fa-icon>
              <span>Chỉnh sửa</span>
            </button>
          } @else {
            <button
              type="button"
              (click)="addToCart(product)"
              class="btn btn-outline-success"
              [disabled]="product.quantity === 0"
              title="Thêm vào giỏ hàng"
            >
              <fa-icon icon="shopping-cart"></fa-icon>
              <span>{{
                product.quantity === 0 ? 'Hết hàng' : 'Thêm giỏ'
              }}</span>
            </button>
            <button
              type="button"
              (click)="buyNow(product)"
              class="btn btn-success"
              [disabled]="product.quantity === 0"
            >
              <fa-icon icon="bolt"></fa-icon>
              <span>{{
                product.quantity === 0 ? 'Hết hàng' : 'Mua ngay'
              }}</span>
            </button>
          }
        </div>
      </div>
    </div>
  }
</div>
