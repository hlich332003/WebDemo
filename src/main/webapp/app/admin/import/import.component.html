<div class="import-container">
  <h2>Import Dữ liệu</h2>

  <div class="import-section">
    <h3>Import Sản phẩm từ File</h3>
    <p>Chọn một file Excel (.xlsx) từ máy tính để import danh sách sản phẩm.</p>
    <input
      type="file"
      (change)="onFileSelected($event, 'products')"
      accept=".xlsx"
      [disabled]="isImportingProducts()"
    />
    @if (isImportingProducts()) {
      <div class="spinner-border spinner-border-sm text-primary" role="status">
        <span class="visually-hidden">Đang import...</span>
      </div>
      <span>Đang import sản phẩm...</span>
    }
  </div>

  <div class="import-section">
    <h3>Import Sản phẩm từ URL</h3>
    <p>Nhập URL của file Excel (.xlsx) online để import danh sách sản phẩm.</p>
    <div class="input-group mb-3">
      <input
        type="text"
        class="form-control"
        placeholder="https://docs.google.com/spreadsheets/d/..."
        [(ngModel)]="productImportUrl"
        [disabled]="isImportingProductsFromUrl()"
      />
      <button
        class="btn btn-primary"
        type="button"
        (click)="onUrlImport('products')"
        [disabled]="!productImportUrl || isImportingProductsFromUrl()"
      >
        Import từ URL
      </button>
    </div>
    @if (isImportingProductsFromUrl()) {
      <div class="spinner-border spinner-border-sm text-primary" role="status">
        <span class="visually-hidden">Đang import...</span>
      </div>
      <span>Đang import sản phẩm từ URL...</span>
    }
  </div>

  <div class="import-section">
    <h3>Import Người dùng từ File</h3>
    <p>
      Chọn một file Excel (.xlsx) từ máy tính để import danh sách người dùng.
    </p>
    <input
      type="file"
      (change)="onFileSelected($event, 'users')"
      accept=".xlsx"
      [disabled]="isImportingUsers()"
    />
    @if (isImportingUsers()) {
      <div class="spinner-border spinner-border-sm text-primary" role="status">
        <span class="visually-hidden">Đang import...</span>
      </div>
      <span>Đang import người dùng...</span>
    }
  </div>

  <div class="import-section">
    <h3>Import Người dùng từ URL</h3>
    <p>
      Nhập URL của file Excel (.xlsx) online để import danh sách người dùng.
    </p>
    <div class="input-group mb-3">
      <input
        type="text"
        class="form-control"
        placeholder="https://docs.google.com/spreadsheets/d/..."
        [(ngModel)]="userImportUrl"
        [disabled]="isImportingUsersFromUrl()"
      />
      <button
        class="btn btn-primary"
        type="button"
        (click)="onUrlImport('users')"
        [disabled]="!userImportUrl || isImportingUsersFromUrl()"
      >
        Import từ URL
      </button>
    </div>
    @if (isImportingUsersFromUrl()) {
      <div class="spinner-border spinner-border-sm text-primary" role="status">
        <span class="visually-hidden">Đang import...</span>
      </div>
      <span>Đang import người dùng từ URL...</span>
    }
  </div>
</div>
